@prefix : <http://example.org#>.
@prefix e: <http://eulersharp.sourceforge.net/2003/03swap/log-rules#>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix list: <http://www.w3.org/2000/10/swap/list#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.


{
  ?graph :getInfo ?info 
}
<=
{
_:x e:findall ( {?s2 ?p2 ?o2} { ?graph log:includes {?s2 ?p2 ?o2}. 
                 ?scope e:call {?s2 ?p2 ?o2}  } ?list2 ).

_:a e:trace 11.

?list2 log:conjunction ?con2.

(?graph ?con2) e:graphIntersection ?con2.

?graph e:graphList ?list.

_:a e:trace 22.
(?list  ()) :replace ?out.

?out log:conjunction ?info.
}.




{
 (() ?out) :replace ?out.
} <= 
{
("!") e:derive true.
}.

{
(?list ?replaced) :replace ?out.
}
<=
{
?list rdf:first ?first.
?list rdf:rest ?rest.

?scope e:call ?first.
_:a e:trace 33.

?first :reliesOn ?triple.



?scope e:call ?triple.

("!") e:derive true.

?scope e:findall (?t {?first :reliesOn ?t. ?scope e:call ?t. } ?res).
(?replaced ?res) list:append ?newReplaced.

(?rest ?newReplaced) :replace ?out.
}.


{
(?list ?replaced) :replace ?out.
}
<=
{
?list rdf:first ?first.
?list rdf:rest ?rest.

_:a e:trace 44.
(?replaced (?first)) list:append ?newReplaced.
_:a e:trace 55. 
(?rest ?newReplaced) :replace ?out.
}.

